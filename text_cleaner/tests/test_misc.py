# -*- coding: utf-8 -*-

from text_cleaner.processor.misc import (
    URL,
    RESTRICT_URL,
    ESCAPED_WHITESPACE,
    WECHAT_EMOJI_EN,
    WECHAT_EMOJI_ZHCN,
    WECHAT_EMOJI,
)


URL = URL.replace('TCURL')
RESTRICT_URL = RESTRICT_URL.replace('TCURL')


def test_url():

    raw = (
        '点击http://t.cn/RtU0mZ1 查看'
    )
    expected = (
        u'点击TCURL 查看'
    )

    assert expected == URL.remove(raw)

    raw = (
        '点击http://173.255.0.1/browser.php?u=test 查看'
    )
    expected = (
        u'点击TCURL 查看'
    )

    assert expected == URL.remove(raw)


def test_url_of_filtering():

    raw = (
        '点击http://t.cn/RtU0mZ1查看'
    )
    expected = (
        u'点击TCURL'
    )

    assert expected == URL.remove(raw)

    raw = (
        '点击http://t.cn/RtU0mZ1查看'
    )
    expected = (
        u'点击TCURL查看'
    )

    assert expected == RESTRICT_URL.remove(raw)


def test_escaped_whitespace():

    raw = (
        '点击\\nhttp://t.cn/RtU0mZ1 \\t查看'
    )
    expected = (
        u'点击 http://t.cn/RtU0mZ1  查看'
    )

    assert expected == ESCAPED_WHITESPACE.remove(raw)


def test_wechat_emoji():

    raw = (
        '[Smile][微笑][这不是表情][not an emoji]'
    )
    expected = (
        u' [微笑][这不是表情][not an emoji]'
    )

    assert expected == WECHAT_EMOJI_EN.remove(raw)

    raw = (
        '[Smile][微笑][这不是表情][not an emoji]'
    )
    expected = (
        u'[Smile] [这不是表情][not an emoji]'
    )

    assert expected == WECHAT_EMOJI_ZHCN.remove(raw)

    raw = (
        '[Smile][微笑][这不是表情][not an emoji]'
    )
    expected = (
        u'  [这不是表情][not an emoji]'
    )

    assert expected == WECHAT_EMOJI.remove(raw)


def test_complicated_url():
    text = u'\u5e73\u7279\u4e94\u7801 2016\u5e74/066\u671f\u2464\u7801\u4e2d\u7279\u5e7303-13-23-33-43\u300c\u5f00\uff1a\u5e7313\u7279\u300d2016\u5e74/067\u671f\u2464\u7801\u4e2d\u7279\u5e7309-19-29-39-49\u300c\u5f00\uff1a\u5e7319.29\u7279\u300d2016\u5e74/069\u671fhttp://www.776222.com01-11-21-31-41\u300c\u5f00\uff1a\u5e7321\u7279\u300d2016\u5e74/070\u671f\u2464\u7801\u4e2d\u7279\u5e7308-18-28-38-48\u300c\u5f00\uff1a\u5e7348\u7279\u300d2016\u5e74/071\u671f\u2464\u7801\u4e2d\u7279\u5e7309-19-29-39-49\u300c\u5f00\uff1a\u5e73\u7279\u300d2016\u5e74/073\u671f\u2464\u7801\u4e2d\u7279\u5e7306-16-26-36-46\u300c\u5f00\uff1a\u5e73\u7279\u300d2016\u5e74/074\u671f\u2464\u7801\u4e2d\u7279\u5e7303-13-23-33-43\u300c\u5f00\uff1a\u5e73\u7279\u300d074\u671f\uff1a\u25c6\u4e03\u6708\u5c0f\u5deb\u25c6\u516d\u5c3ewww.30889com\u30101-3-5-6-4-9\u3011\u5f00:00\u8d5a071\u671f\u25c6\u95ea\u7535\u98ce\u66b4http://www.767222.com\u5e73\u7279\u4e8c\u7801\u3010\u219809.21\u2199\u3011\u5f00:\u5e7300\u51c6073\u671f\uff1a\u5c0f\u5fc3\u5237\u7206\u254b\u6570\u636e\u2461\u7801\u301021.11\u3011\u5f00\uff1aX\u4e2dV073\u671f\uff1a\u5927\u5934\u54e5\u25c6\u2474\u8096\u4e3b\u3220\u7801\u3010\u7334\uff1a49\u3011\u5f00\uff1a0X0\u51c6073\u671f:\u2570\u68cb\u827a\u7cbe\u6e5b\u256e\u25cf\u2198\u7206\u6599\u2199\u2460\u8096+2\u7801\u2197\u3010\u7f8a02\uff0b24.23\u3011\u5f00:\uff1f00\u51c6073\u671f\uff1a\u60c5\u4eba\u77f3\u25c6\u516d\u6bb5\u4e2d\u7279\u30101\u6bb53\u6bb54\u6bb55\u6bb56\u6bb57\u6bb5\u3011\u5f00\uff1f3500\u4e2d074\u671f\uff08\u4ed9\u4eba\u6307\u7279\u5fc5\u80dc\u4e94\u6bb5\uff091\u6bb53\u6bb55\u6bb56\u6bb57\u6bb5\uff08\u5f00\uff1f00\u51c6\uff01\uff09072\u671f\uff1a\u2605\u597d\u8fd0\u4e00\u751f\u2605\u5927\u5c0f\u4e2d\u7279\u25b3\u5927\u6570\u25b3\u5f0036\u51c6073\u671f\uff1a\u2605\u597d\u8fd0\u4e00\u751f\u2605\u5927\u5c0f\u4e2d\u7279\u25b3\u5927\u6570\u25b3\u5f0035\u51c6http://www.508555.com/074\u671f\uff1a\u2605\u597d\u8fd0\u4e00\u751f\u2605\u5927\u5c0f\u4e2d\u7279\u25b3\u5927\u6570\u25b3\u5f0000\u51c6http://www.006449.com/074\u671f:\u51b0\u5c71\u96ea\u4eba\u5fc5\u4e2d\u7279\u6bb5:01---2425---40\u3000\u5f00\uff08??\uff09\u51c6073\u671f\uff1a\u2640\u98ce\u7684\u81ea\u7531\u2642\u254b3\u5934\u4e2d\u7279\u254b\u4e3b\u300a2.3\u5934\u300b\u9632\u300a4\u5934\u300b\u254b\u5f00\uff1a\u72d735\u4e2d074\u671f\uff1a\u2640\u98ce\u7684\u81ea\u7531\u2642\u254b3\u5934\u4e2d\u7279\u254b\u4e3b\u300a0.1\u5934\u300b\u9632\u300a4\u5934\u300b\u254b\u5f00\uff1a0000\u4e2d74\u671f\uff1a\u4e2d\u5956\u5f00\u95e8\u2192\u4e09\u95e8\u4e2d\u7279\u2190\u3010145\u3011\u95e8\u5f0000\u51c6X073\u671f:\u3010\u7b97\u9a6c\u7532\u3011\u7cbe\u51c6\u58f9\u6ce2\u2605\u3010\u84dd\u6ce2+\u5355\u3011\u2605\u5f00:35\u8d5a072\u671f\uff1a\u5730\u5e73\u697c\u9ad8\u2605\u5355\u53cc\u4e2d\u7279=\u3010=\u53cc\u6570=\u3011=\u5f00\u9e2136\u5bf9073\u671f\uff1a\u5730\u5e73\u697c\u9ad8\u2605\u5355\u53cc\u4e2d\u7279=\u3010=\u5355\u6570=\u3011=\u5f0035\u5bf9073\u671f\uff1a\u82b1\u5bb9\u6708\u8c8c\u2606\u9876\u7ea7\u5e73\u7279\u3016\u5154\u3017\u5f00\uff1a060073\u671f:\u3010\u7199\u6518\u3011\u5bb6\u91ce\u4e2d\u7279\u3010\u2192\u91ce\u517d\u2192\u3011\u5f00:X\u8d62073\u671f\uff1a\u91d1\u8272\u7ae5\u5e74\u2229\u5e73\u7279\u2460\u8096\u4e3b\uff12\u7801\u3010\u732a\u02c734.46\u3011\u5f0000\u51c6071\u671f\uff1a\u67e0\u6aac\u4e0d\u840c\u25c6\u5e73\u7279\u4e00\u8096\u3010\u7334\u3011\u5e73\u7279:00\u51c6070\u671f\uff1a\u25c6\u81f3\u5c0a\u96c0\u738b\u25c6\u2192\u5e73\u7279\u2475\u4e2d\u2474\u256a\u301028.38\u3011\u256a\u5f00\uff1a48\u51c6.\u3002071\u671f\uff1a\u25c6\u81f3\u5c0a\u96c0\u738b\u25c6\u2192\u5e73\u7279\u2475\u4e2d\u2474\u256a\u301035.45\u3011\u256a\u5f00\uff1aX00\u51c6.070\u671f(\u603b\u51a0\u519b)\u5e73\u7279\u2489\u4e2d\u2488\u2192\u300a38.48\u300b\u2190\u5f00:48\u51c6071\u671f(\u603b\u51a0\u519b)\u5e73\u7279\u2489\u4e2d\u2488\u2192\u300a27.39\u300b\u2190\u5f00:X00\u51c6071\u671f\uff1a\u94f6\u6cb3\u6218\u8230\u2605\u5e73\u7279\u2489\u7801http://www.00887.com/\u301032.42\u3011\u5f00\uff1a\u5e73\u727900\u51c62016\u5e74/073\u671f\u2464\u7801http://www.730889.com\u4e2d\u7279\u5e7321-16-32-38-19\u5f00\uff1a\u5e73\u7279073\u671f\uff1a\u7edd\u5bf9\u75f4\u5fc3\u221d\u4e2d\u7279\u248a\u7801http://www.730889.com/\u300e112133\u300f\u5f00\uff1a00\u51c6068\u671f\uff1a*\u5f00http://www.00887.com\uff1a00\u9519073\u671f\uff1a\uff02\u9022\u51f6\u5316\u5409\uff02\u4e70\u4e86\u5c31\u4e2d\u3010\u7334\u72d7\u864e\u7f8a\u732a\u5154\u3011\u5f00\uff1a\uff1f00\u4e2d\u3002069\u671f\uff1a\u300e\u5929\u547d\u6240\u5f52\u300f\uff06\u248b\u5b57\u7206\u5e73\u7279*\u3010\u9f50\u5929\u5927\u5723\u3011*\u5f00\uff1a49\u4e2d\u3002070\u671f\uff1a\u300e\u5929\u547d\u6240\u5f52\u300f\uff06\u248b\u5b57\u7206\u5e73\u7279*\u3010\u5b88\u682a\u5f85\u5154\u3011*\u5f00\uff1a06\u4e2d\u3002071\u671f\uff1a\u300e\u5929\u547d\u6240\u5f52\u300f\uff06\u248b\u5b57\u7206\u5e73\u7279*\u3010\u559c\u6c14\u7f8a\u3011*\u5f00.38\u4e2d073\u671f\uff1a\u300e\u5929\u547d\u6240\u5f52\u300f\uff06\u248b\u5b57\u7206\u5e73\u7279*\u3010\u72d7\u5934\u519b\u5e08\u3011*\u5f00\uff1a35\u4e2d073\u671f\uff1a\u94f6\u6cb3\u6218\u8230\u2605\u5e73\u7279\u2489\u7801\u301036.46\u3011\u5f00\uff1aX073\u671f\uff1a\u25c6\u81f3\u5c0a\u96c0\u738b\u25c6\u2192\u5e73\u7279\u2475\u4e2d\u2474\u256a\u301008.18\u3011\u256a\u5f00\uff1aX.073\u671f\uff1a\u2516\u72c2\u6b22\u5b63\u2511\u25c6\u2475\u5b57\u7206\u5e73\u7279\u25c6\u300a\u8001\u9f20\u300b\u5f00\uff1aX\u51c6073\u671f\uff1a\u25b2\u6587\u827a\u590d\u5174\uff02\u4e24\u5b57\u7206\u5e73\u7279\u3010\u5c0f\u72d7\u3011\u5f00\uff1a35\u51c6073\u671f\uff1a\u2211\u6b66\u4fa0\u5927\u7247\u25c6\u5e73\u7279\uff12\u4e2d\uff11\u301014.34\u3011\u2192\u5f00\uff1aX{\u4e2d}068\u671f:\u56fd\u5b66\u5927\u5e08\u2192\u4e09\u4e2a\u5934\u2588012\u5934\u2588\u5f00\uff1a24\u51c6\u3000069\u671f:\u56fd\u5b66\u5927\u5e08\u2192\u4e09\u4e2a\u5934\u2588034\u5934\u2588\u5f00\uff1a49\u51c6070\u671f:\u56fd\u5b66\u5927\u5e08\u2192\u4e09\u4e2a\u5934\u2588012\u5934\u2588\u5f00\uff1a29\u51c6http://www.781212.com/071\u671f:\u56fd\u5b66\u5927\u5e08\u2192\u4e09\u4e2a\u5934\u2588024\u5934\u2588\u5f00\uff1aX00\u51c6\u3000http://www.355555.com070\u671f:\u226e\u91d1\u5c71\u94f6\u5c71\u226f\u4e70\u4ec0\u4e48\u90fd\u8d5a\u25cf\u5927\u6570\u5927\u6570\u5927\u6570\u25cf\u5f00:\uff1f2900\u51c6068\u671f\uff1a\u7248\u4e3b\u63a8\u8350http://www609888.com\u516d\u7801\u25c6\u301030.49.13.22.46.12\u3011\u25c6\u5f0000\u4e2d067\u671f\u2227\u5929\u9e45\u6e56\u2228\u5e73\u7279\u2461\u7801\u203b\u226e24.36\u226f\u203b\u5f00:\u5e73\u727948\u51c6068\u671f\u2227\u5929\u9e45\u6e56\u2228\u5e73\u7279\u2461\u7801\u203b\u226e28.42\u226f\u203b\u5f00:\u5e73\u727900\u51c6067\u671f\uff1a\u2264\u9053\u7834\u5929\u673a\u2265\u256a\u5e73\u7279\u2475\u4e2d\u2474\u256a\u301016.46\u3011\u5f00\uff1a00\u9519068\u671f\uff1a\u2264\u9053\u7834\u5929\u673a\u2265\u256a\u5e73\u7279\u2475\u4e2d\u2474\u256a\u301012.32\u3011\u5f00\uff1a00\u51c6http://www.00887.com067\u671f\uff1a\u25c6\u81f3\u5c0a\u96c0\u738b\u25c6\u2192\u5e73\u7279\u2475\u4e2d\u2474\u256a\u301025.35\u3011\u256a\u5f00\uff1a00\u51c6.066\u671f\uff1a\u2264\u9053\u7834\u5929\u673a\u2265\u256a\u5e73\u7279\u2475\u4e2d\u2474\u256a\u301016.26\u3011\u5f00\uff1a36\u51c6\u3002067\u671f\uff1a\u2264\u9053\u7834\u5929\u673a\u2265\u256a\u5e73\u7279\u2475\u4e2d\u2474\u256a\u301016.46\u3011\u5f00\uff1a00\u51c6066\u671f\uff1a\u25e3\u62f3\u738b\u4e89\u9738\u25e2\u5e73\u7279\u248a\u4e2d\u2474\u301012.22.32\u3011\u5e73\u7279\u5f00\uff1a00\u9519067\u671f\uff1a\u25e3\u62f3\u738b\u4e89\u9738\u25e2\u5e73\u7279\u248a\u4e2d\u2474\u301018.28.48\u3011\u5e73\u7279\u5f00\uff1a00\u51c6066\u671f\uff1a\u3013\u5f69\u9738\u738b\u30133\u5934\u30100\u59342\u59343\u5934\u3011\u5f00\uff1a37\u4e2dhttp://www.tm2005.com067\u671f\uff1a\u3013\u5f69\u9738\u738b\u30133\u5934\u30100\u59341\u59343\u5934\u3011\u5f00\uff1a04\u4e2d068\u671f\uff1a\u3013\u5f69\u9738\u738b\u30133\u5934\u30101\u59342\u59343\u5934\u3011\u5f00\uff1a00\u4e2d067\u671f\uff1a\u795e\u7b97\u9601*\u9999\u6e2f\u6b63\u7248\u6740\u4e00\u6ce2\u3010\u7ea2\u3011\u5f00:\u84dd04\u4e2d068\u671f\uff1a\u795e\u7b97\u9601*\u9999\u6e2f\u6b63\u7248\u6740\u4e00\u6ce2\u3010\u7ea2\u3011\u5f00:\uff1f00\u4e2d066\u671f\uff1a\u571f\u8c6a\u91d1\u25c6\u4e03\u5c3e\u30103456789\u3011\u5f00:37\u4e2d067\u671f\uff1a\u571f\u8c6a\u91d1\u25c6\u4e03\u5c3e\u30102345678\u3011\u5f00:04\u4e2d068\u671f\uff1a\u571f\u8c6a\u91d1\u25c6\u4e03\u5c3e\u30102356789\u3011\u5f00:00\u4e2d067\u671f\uff1a\u6c99\u7cd6\u6854\u2103\u4e5d\u8096\u3010\u725b\u7f8a\u9e21\u732a\u5154\u9f99\u7334\u9f20\u864e\u3011\u5f00:\u86c704\u9519068\u671f\uff1a\u6c99\u7cd6\u6854\u2103\u4e5d\u8096\u3010\u7334\u7f8a\u9a6c\u86c7\u9f99\u5154\u864e\u725b\u72d7\u3011\u5f00:0000\u4e2d068\u671f\uff1a\u226e\u7ef4\u4e5f\u7eb3\u226f\u7cbe\u51c6\u4e94\u6bb5\uff1a2\u6bb53\u6bb54\u6bb55\u6bb56\u6bb5\u5f00\uff1a\uff1f00\u4e2d068\u671f\uff1a\u5fc3\u7075\u8df3\u52a8\u25c6\u4e8c\u6ce2\u2237\u226e\u2299\u84dd\u7eff\u2299\u226f\u2237\u5f00:\uff1f\u6ce2\u2192\u4e2dXX068\u671f\uff1a\u963f\u897f\u2587\u56db\u884c\u2192\u300a\u6728\u6c34\u706b\u571f\u300b\u2190\u5f00\uff1a\uff1f00\u4e2d\u7b2c067\u671f\u63a8\u8350\u5e73\u7279\u4e94\u7801http://www.006449.com\u7b2c071\u671f\u63a8\u8350\u5e73\u7279\u4e94\u78011627332223153842432210\u7279:18http://www.006449.com\u7b2c073\u671f\u63a8\u8350\u5e73\u7279\u4e94\u78012224232013074\u671f\u63a8\u8350\u5e73\u7279\u4e94\u78010327161426068\u671f:\u5e73\u7279\u4e00\u8096\u4e3b\u4e09\u7801\u3010http://www.776222.com\u86c704.28.40\u3011\u8d4c\u8c6a\u5f0000\u51c6074\u671f:\u5e73\u7279\u4e00\u8096\u4e3b\u4e09\u7801\u3010\u9a6c03.15.27\u3011\u8d4c\u8c6a\u5f0000\u51c6073\u671f:\u02c7\u6295\u8d44\u5927\u5e08\u02c7\u671f\u7206\u6599\u3010\u9a6c\u5154\u7334\u9e21\u72d7\u864e\u3011\u4e2d:\u72d735\u8d5ahttp://www.30889.com074\u671f:\u02c7\u6295\u8d44\u5927\u5e08\u02c7\u671f\u7206\u6599\u3010\u9f20\u9a6c\u732a\u72d7\u864e\u9f99\u3011\u4e2d:\uff1f00\u8d5ahttp://www.30889.com074\u671f\ufe64\u6e2f\u8d22\u795e\ufe65\u706b\u7206\u5bb6\u91ce\u2192\u2016\u91ce\u517d\xb1\u7f8a\u2016\u2190\u5f00:\uff1f0\u7b2c072\u671f\u2520\u805a\u8d22\u591a\u2528\u5e73\u7279\u4e00\u8096\u653b\u4e8c\u7801\u3010\u864e\u2192\u653b\u219207.31\u3011\u5f0007\u51c6www.400444.com\u7b2c073\u671f\u2520\u805a\u8d22\u591a\u2528\u5e73\u7279\u4e00\u8096\u653b\u4e8c\u7801\u3010\u9a6c\u2192\u653b\u219215.39\u3011\u5f00X00\u51c6X073\u671f:\u62fc\u640f\u594b\u6597\u25c6\u5355\u4e09\u5c3e\u3010157\u5c3e\u3011\u53cc\u4e09\u5c3e\u3010246\u5c3e\u3011\u25c6\u5f00:35\u51c6072\u671f\uff1a\u25b2\u5c0f\u6865\u6d41\u6c34\u25b2\u516c\u5f0f\u4e09\u6bb5\u221d\u30105\u6bb56\u6bb57\u6bb5\u3011\u221d\u5f00\uff1a\u9e2136\u51c6073\u671f\uff1a\u25b2\u5c0f\u6865\u6d41\u6c34\u25b2\u516c\u5f0f\u4e09\u6bb5\u221d\u30102\u6bb53\u6bb56\u6bb5\u3011\u221d\u5f00\uff1a\uff1f00\u51c6http://www.7489.com   \n'  # noqa
    # deal with catastrophic backtracking.
    URL.remove(text)
